<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Send_Field_New_Case_Email</name>
        <label>Send Field New Case Email</label>
        <locationX>942</locationX>
        <locationY>362</locationY>
        <actionName>Case.Field_Work_Order_Received</actionName>
        <actionType>emailAlert</actionType>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_IT_New_Case_Email</name>
        <label>Send IT New Case Email</label>
        <locationX>948</locationX>
        <locationY>477</locationY>
        <actionName>Case.IT_New_Case_Notification</actionName>
        <actionType>emailAlert</actionType>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_NE_Outage_Email</name>
        <label>Send NE - Outage Email</label>
        <locationX>535</locationX>
        <locationY>683</locationY>
        <actionName>Case.NE_Outage_New_Case_Notification</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Update_Account</targetReference>
        </connector>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_New_Case_Support</name>
        <label>Send New Case Support</label>
        <locationX>932</locationX>
        <locationY>123</locationY>
        <actionName>Case.Support_Work_Order_Recieved</actionName>
        <actionType>emailAlert</actionType>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_New_NE_Maint_Case_Email</name>
        <label>Send New NE- Maint Case Email</label>
        <locationX>362</locationX>
        <locationY>593</locationY>
        <actionName>Case.NE_Maintenance_New_Case_Notification</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Update_Account_on_NE_Maint_Case</targetReference>
        </connector>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_New_NE_Request_Emal</name>
        <label>Send New NE - Request Emal</label>
        <locationX>697</locationX>
        <locationY>774</locationY>
        <actionName>Case.NE_Request_New_Case_Notification</actionName>
        <actionType>emailAlert</actionType>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_NSE_New_Case_Email</name>
        <label>Send NSE New Case Email</label>
        <locationX>936</locationX>
        <locationY>240</locationY>
        <actionName>Case.NSE_Work_Order_Received</actionName>
        <actionType>emailAlert</actionType>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_SD_New_Case_Email</name>
        <label>Send SD New Case Email</label>
        <locationX>949</locationX>
        <locationY>600</locationY>
        <actionName>Case.SD_New_Case_Notification</actionName>
        <actionType>emailAlert</actionType>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <assignments>
        <name>Do_Nothing</name>
        <label>Do Nothing</label>
        <locationX>23</locationX>
        <locationY>21</locationY>
        <assignmentItems>
            <assignToReference>vCaseId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>000000095623</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_User_s_Contact_ID</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Case_Fields</name>
        <label>Set Case Fields</label>
        <locationX>335</locationX>
        <locationY>366</locationY>
        <assignmentItems>
            <assignToReference>objCase.ContactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>fCaseContact</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>objCase.Origin</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>fOrigin</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Save_Case_Changes</targetReference>
        </connector>
    </assignments>
    <constants>
        <name>cField</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Field</stringValue>
        </value>
    </constants>
    <constants>
        <name>cIT</name>
        <dataType>String</dataType>
        <value>
            <stringValue>IT</stringValue>
        </value>
    </constants>
    <constants>
        <name>cMaintAccout</name>
        <dataType>String</dataType>
        <value>
            <stringValue>0010e00001K7Cj4AAF</stringValue>
        </value>
    </constants>
    <constants>
        <name>cNEMaint</name>
        <dataType>String</dataType>
        <value>
            <stringValue>NE - Maintenance</stringValue>
        </value>
    </constants>
    <constants>
        <name>cNEOut</name>
        <dataType>String</dataType>
        <value>
            <stringValue>NE - Outage</stringValue>
        </value>
    </constants>
    <constants>
        <name>cNeRequest</name>
        <dataType>String</dataType>
        <value>
            <stringValue>NE - Request</stringValue>
        </value>
    </constants>
    <constants>
        <name>cNeRequestAcct</name>
        <dataType>String</dataType>
        <value>
            <stringValue>0010e00001K87oO</stringValue>
        </value>
    </constants>
    <constants>
        <name>cNSE</name>
        <dataType>String</dataType>
        <value>
            <stringValue>NSE</stringValue>
        </value>
    </constants>
    <constants>
        <name>cOutageAcct</name>
        <dataType>String</dataType>
        <value>
            <stringValue>0010e00001K7aBq</stringValue>
        </value>
    </constants>
    <constants>
        <name>cSoftwareDevelopment</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Software Development</stringValue>
        </value>
    </constants>
    <constants>
        <name>cSupport</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Support</stringValue>
        </value>
    </constants>
    <constants>
        <name>cWorkOrder</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Support Work Order</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Ticket_Type</name>
        <label>Ticket Type</label>
        <locationX>687</locationX>
        <locationY>365</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>Support</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objCase.Work_Order_Queue__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cSupport</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>vRecordType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cWorkOrder</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_New_Case_Support</targetReference>
            </connector>
            <label>Support</label>
        </rules>
        <rules>
            <name>NSE</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objCase.Work_Order_Queue__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cNSE</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>vRecordType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cWorkOrder</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_NSE_New_Case_Email</targetReference>
            </connector>
            <label>NSE</label>
        </rules>
        <rules>
            <name>Field</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objCase.Work_Order_Queue__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cField</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>vRecordType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cWorkOrder</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Field_New_Case_Email</targetReference>
            </connector>
            <label>Field</label>
        </rules>
        <rules>
            <name>IT</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vRecordType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cIT</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_IT_New_Case_Email</targetReference>
            </connector>
            <label>IT</label>
        </rules>
        <rules>
            <name>Software_Development</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vRecordType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cSoftwareDevelopment</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_SD_New_Case_Email</targetReference>
            </connector>
            <label>Software Development</label>
        </rules>
        <rules>
            <name>NE_Maintenance</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vRecordType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cNEMaint</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_New_NE_Maint_Case_Email</targetReference>
            </connector>
            <label>NE - Maintenance</label>
        </rules>
        <rules>
            <name>NE_Outage</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vRecordType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cNEOut</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_NE_Outage_Email</targetReference>
            </connector>
            <label>NE - Outage</label>
        </rules>
        <rules>
            <name>NE_Request</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vRecordType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cNeRequest</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_New_NE_Request_Emal</targetReference>
            </connector>
            <label>NE - Request</label>
        </rules>
    </decisions>
    <description>Set unique fields for internal Cases and send emails depending on Record Type/Work Order Queue 
2/26/18 - Don&#39;t change Case Contact if it is already set. 3/7/2018 - Update to add New Record Type (NE - Maintenance) also added a field update after the email is sent. 3/16/2018 - Update to add New Record Type (NE - Outage) also added a field update after the email is sent.  4/2/2018 - Update to add New Record Type (NE - Request) also added a field update after the email is sent.
8/31/18 - ers - Allow for Automated Process Origin (#60845)</description>
    <formulas>
        <description>Don&#39;t change if Contact is already set.  When a Case is created from a Chatter Comment (#ticket), the Contact is set to the Chatter post creator.</description>
        <name>fCaseContact</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!objCase.ContactId}),{!vUserContactID},{!objCase.ContactId})</expression>
    </formulas>
    <formulas>
        <name>fContactUserID</name>
        <dataType>String</dataType>
        <expression>CASESAFEID({!$User.Id})</expression>
    </formulas>
    <formulas>
        <name>fOrigin</name>
        <dataType>String</dataType>
        <expression>IF(TEXT({!objCase.Origin})=&quot;Automated Process&quot;,&quot;Automated Process&quot;,&quot;Agent&quot;)</expression>
    </formulas>
    <interviewLabel>Case - New Internal Case Processing {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Case - New Internal Case Processing</label>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Case_Record</name>
        <label>Get Case Record</label>
        <locationX>157</locationX>
        <locationY>240</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Record_Type_Name</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </filters>
        <object>Case</object>
        <outputReference>objCase</outputReference>
        <queriedFields>ContactId</queriedFields>
        <queriedFields>Origin</queriedFields>
        <queriedFields>RecordTypeId</queriedFields>
        <queriedFields>Work_Order_Queue__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Record_Type_Name</name>
        <label>Get Record Type Name</label>
        <locationX>158</locationX>
        <locationY>364</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Case_Fields</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>objCase.RecordTypeId</elementReference>
            </value>
        </filters>
        <object>RecordType</object>
        <outputAssignments>
            <assignToReference>vRecordType</assignToReference>
            <field>Name</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_User_s_Contact_ID</name>
        <label>Get User&#39;s Contact ID</label>
        <locationX>159</locationX>
        <locationY>120</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Case_Record</targetReference>
        </connector>
        <filters>
            <field>User__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>fContactUserID</elementReference>
            </value>
        </filters>
        <object>Contact</object>
        <outputAssignments>
            <assignToReference>vUserContactID</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordUpdates>
        <name>Save_Case_Changes</name>
        <label>Save Case Changes</label>
        <locationX>506</locationX>
        <locationY>365</locationY>
        <connector>
            <targetReference>Ticket_Type</targetReference>
        </connector>
        <inputReference>objCase</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Account</name>
        <label>Update Account</label>
        <locationX>359</locationX>
        <locationY>687</locationY>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>cOutageAcct</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Account_on_NE_Maint_Case</name>
        <label>Update Account on NE Maint Case</label>
        <locationX>208</locationX>
        <locationY>596</locationY>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>cMaintAccout</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <startElementReference>Get_User_s_Contact_ID</startElementReference>
    <status>Active</status>
    <variables>
        <name>objCase</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Case</objectType>
    </variables>
    <variables>
        <name>vCaseId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>vRecordType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>vUserContactID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
