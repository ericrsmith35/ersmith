<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <assignments>
        <name>Do_Nothing</name>
        <label>Do Nothing</label>
        <locationX>28</locationX>
        <locationY>14</locationY>
        <assignmentItems>
            <assignToReference>vOppID</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0060e00001raahy</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Opportunity_Record</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Save_Contract_ID</name>
        <label>Save Contract ID</label>
        <locationX>1064</locationX>
        <locationY>440</locationY>
        <assignmentItems>
            <assignToReference>objOpp.ContractId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>vContract</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_End_Date_Only</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Selected_Contract</name>
        <label>Selected Contract</label>
        <locationX>882</locationX>
        <locationY>438</locationY>
        <assignmentItems>
            <assignToReference>vContract</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Select_Contract_Top</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Save_Contract_ID</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Selected_Contract_1</name>
        <label>Selected Contract</label>
        <locationX>882</locationX>
        <locationY>544</locationY>
        <assignmentItems>
            <assignToReference>vContract</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Select_Contract_0</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Save_Contract_ID</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>This trigger must be set or a Contract must be linked to the Opportunity in order to progress to Need Identification stage.</description>
        <name>Set_Contract_Check_Trigger</name>
        <label>Set Contract Check Trigger</label>
        <locationX>202</locationX>
        <locationY>207</locationY>
        <assignmentItems>
            <assignToReference>objOpp.Trigger_Contract_Check__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_Opp_Type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_Start_Date</name>
        <label>Update Start Date</label>
        <locationX>1236</locationX>
        <locationY>320</locationY>
        <assignmentItems>
            <assignToReference>objContract.StartDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>fExtend</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>objContract.Last_Extended_On__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Save_Change</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Active_Contract_Found</name>
        <label>Active Contract Found?</label>
        <locationX>204</locationX>
        <locationY>408</locationY>
        <defaultConnector>
            <targetReference>Check_Account_for_Contracts_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NO</defaultConnectorLabel>
        <rules>
            <name>YESc</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objContract</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Different_Top_Account</targetReference>
            </connector>
            <label>YES</label>
        </rules>
    </decisions>
    <decisions>
        <name>Active_Contract_Found_0</name>
        <label>Active Contract Found?</label>
        <locationX>21</locationX>
        <locationY>491</locationY>
        <defaultConnector>
            <targetReference>No_Active_Contract</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NO</defaultConnectorLabel>
        <rules>
            <name>YESc_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objContract</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Different_Top_Account</targetReference>
            </connector>
            <label>YES</label>
        </rules>
    </decisions>
    <decisions>
        <name>Change_Contract</name>
        <label>Change Contract?</label>
        <locationX>508</locationX>
        <locationY>313</locationY>
        <defaultConnector>
            <targetReference>Save_Updated_Opp_Record</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NO</defaultConnectorLabel>
        <rules>
            <name>CHANGE</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Change_Linked_Contract</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Different_Top_Account</targetReference>
            </connector>
            <label>CHANGE</label>
        </rules>
    </decisions>
    <decisions>
        <name>Change_Date</name>
        <label>Change Date?</label>
        <locationX>1415</locationX>
        <locationY>221</locationY>
        <defaultConnector>
            <targetReference>Save_Updated_Opp_Record</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NO</defaultConnectorLabel>
        <rules>
            <name>YES0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vEndDate</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>New_End_Date</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Start_Date</targetReference>
            </connector>
            <label>YES</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Opp_Type</name>
        <label>Check Opp Type</label>
        <locationX>358</locationX>
        <locationY>209</locationY>
        <defaultConnector>
            <targetReference>Wrong_Opp_Type</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>DO NOT ASSIGN</defaultConnectorLabel>
        <rules>
            <name>SELECT</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>fOppTypeCheck</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Assigned</targetReference>
            </connector>
            <label>SELECT</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contract_Assigned</name>
        <label>Contract Assigned?</label>
        <locationX>201</locationX>
        <locationY>313</locationY>
        <defaultConnector>
            <targetReference>Already_Linked</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>YES</defaultConnectorLabel>
        <rules>
            <name>NO</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objOpp.ContractId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Account_for_Contracts</targetReference>
            </connector>
            <label>NO</label>
        </rules>
    </decisions>
    <decisions>
        <name>Different_Top_Account</name>
        <label>Different Top Account?</label>
        <locationX>207</locationX>
        <locationY>497</locationY>
        <defaultConnector>
            <targetReference>Select_Contract</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NO</defaultConnectorLabel>
        <rules>
            <name>YES</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objOpp.AccountId</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>objOpp.Top_Account__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>objOpp.Top_Account__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Select_Contract_1</targetReference>
            </connector>
            <label>YES</label>
        </rules>
    </decisions>
    <decisions>
        <name>Different_Top_Account_1</name>
        <label>Different Top Account?</label>
        <locationX>668</locationX>
        <locationY>488</locationY>
        <defaultConnector>
            <targetReference>Selected_Contract_1</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NO</defaultConnectorLabel>
        <rules>
            <name>NOT_SELECTED</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Select_Contract_0</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Select_Contract_Top</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Save_Updated_Opp_Record</targetReference>
            </connector>
            <label>NOT SELECTED</label>
        </rules>
        <rules>
            <name>YES1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objOpp.AccountId</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>objOpp.Top_Account__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>objOpp.Top_Account__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Selected_Contract</targetReference>
            </connector>
            <label>YES</label>
        </rules>
    </decisions>
    <description>Check to see if the Account or Top Account for the Opportunity has any activated Contracts.  If so, allow one to be selected.</description>
    <dynamicChoiceSets>
        <name>ActivatedContracts</name>
        <dataType>String</dataType>
        <displayField>Selection_Text__c</displayField>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>objOpp.AccountId</elementReference>
            </value>
        </filters>
        <filters>
            <field>StatusCode</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Activated</stringValue>
            </value>
        </filters>
        <object>Contract</object>
        <sortField>ContractNumber</sortField>
        <sortOrder>Asc</sortOrder>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>ActivatedContractsTop</name>
        <dataType>String</dataType>
        <displayField>Selection_Text__c</displayField>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>objOpp.Top_Account__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>StatusCode</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Activated</stringValue>
            </value>
        </filters>
        <object>Contract</object>
        <sortField>ContractNumber</sortField>
        <sortOrder>Asc</sortOrder>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <formulas>
        <name>fExtend</name>
        <dataType>Date</dataType>
        <expression>{!objContract.StartDate}+({!New_End_Date}-{!vEndDate})</expression>
    </formulas>
    <formulas>
        <description>Check to see if Opportunity Type is one that allows an existing Contract to be linked to the Opportunity</description>
        <name>fOppTypeCheck</name>
        <dataType>Boolean</dataType>
        <expression>OR(
TEXT({!objOpp.Type})=&#39;Add/Move/Change&#39;,
TEXT({!objOpp.Type})=&#39;Service Reduction&#39;,
LEFT(TEXT({!objOpp.Type}),3)=&#39;Ren&#39;
)</expression>
    </formulas>
    <interviewLabel>Opportunity - Check/Select Contract {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Opportunity - Check/Select Contract</label>
    <processType>Flow</processType>
    <recordLookups>
        <name>Check_Account_for_Contracts</name>
        <label>Check Account for Contracts</label>
        <locationX>17</locationX>
        <locationY>312</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Active_Contract_Found</targetReference>
        </connector>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>objOpp.AccountId</elementReference>
            </value>
        </filters>
        <filters>
            <field>StatusCode</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Activated</stringValue>
            </value>
        </filters>
        <object>Contract</object>
        <outputReference>objContract</outputReference>
    </recordLookups>
    <recordLookups>
        <name>Check_Account_for_Contracts_0</name>
        <label>Check Top Account for Contracts</label>
        <locationX>20</locationX>
        <locationY>405</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Active_Contract_Found_0</targetReference>
        </connector>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>objOpp.Top_Account__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>StatusCode</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Activated</stringValue>
            </value>
        </filters>
        <object>Contract</object>
        <outputReference>objContract</outputReference>
    </recordLookups>
    <recordLookups>
        <name>Get_Contract</name>
        <label>Get Contract</label>
        <locationX>1423</locationX>
        <locationY>445</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Change_End_Date</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vContract</elementReference>
            </value>
        </filters>
        <object>Contract</object>
        <outputReference>objContract</outputReference>
        <queriedFields>StartDate</queriedFields>
        <queriedFields>ContractTerm</queriedFields>
        <queriedFields>Id</queriedFields>
        <queriedFields>Last_Extended_On__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_End_Date_Only</name>
        <label>Get End Date Only</label>
        <locationX>1245</locationX>
        <locationY>443</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Contract</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vContract</elementReference>
            </value>
        </filters>
        <object>Contract</object>
        <outputAssignments>
            <assignToReference>vEndDate</assignToReference>
            <field>EndDate</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_Opportunity_Record</name>
        <label>Get Opportunity Record</label>
        <locationX>202</locationX>
        <locationY>103</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Contract_Check_Trigger</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vOppID</elementReference>
            </value>
        </filters>
        <object>Opportunity</object>
        <outputReference>objOpp</outputReference>
        <queriedFields>AccountId</queriedFields>
        <queriedFields>Top_Account__c</queriedFields>
        <queriedFields>ContractId</queriedFields>
        <queriedFields>Trigger_Contract_Check__c</queriedFields>
        <queriedFields>Contract_Number__c</queriedFields>
        <queriedFields>Type</queriedFields>
    </recordLookups>
    <recordUpdates>
        <name>Save_Change</name>
        <label>Save Change</label>
        <locationX>1062</locationX>
        <locationY>318</locationY>
        <connector>
            <targetReference>Save_Updated_Opp_Record</targetReference>
        </connector>
        <inputReference>objContract</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Save_Updated_Opp_Record</name>
        <label>Save Updated Opp Record</label>
        <locationX>666</locationX>
        <locationY>314</locationY>
        <inputReference>objOpp</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Save_Updated_Opp_Record_0</name>
        <label>Save Updated Opp Record</label>
        <locationX>207</locationX>
        <locationY>594</locationY>
        <inputReference>objOpp</inputReference>
    </recordUpdates>
    <screens>
        <name>Already_Linked</name>
        <label>Already Linked</label>
        <locationX>357</locationX>
        <locationY>314</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Change_Contract</targetReference>
        </connector>
        <fields>
            <name>Msg</name>
            <fieldText>&lt;DIV ALIGN=&quot;LEFT&quot;&gt;&lt;FONT FACE=&quot;Arial&quot; STYLE=&quot;font-size:12px&quot; COLOR=&quot;#FF0000&quot; LETTERSPACING=&quot;0&quot; KERNING=&quot;0&quot;&gt;This Opportunity is already linked to Contract #&lt;B&gt;{!objOpp.Contract_Number__c}&lt;/B&gt;.  &lt;/FONT&gt;&lt;/DIV&gt;&lt;DIV ALIGN=&quot;LEFT&quot;&gt;&lt;FONT FACE=&quot;Arial&quot; STYLE=&quot;font-size:12px&quot; COLOR=&quot;#FF0000&quot; LETTERSPACING=&quot;0&quot; KERNING=&quot;0&quot;&gt;&lt;/FONT&gt;&lt;/DIV&gt;&lt;DIV ALIGN=&quot;LEFT&quot;&gt;&lt;FONT FACE=&quot;Arial&quot; STYLE=&quot;font-size:12px&quot; COLOR=&quot;#000000&quot; LETTERSPACING=&quot;0&quot; KERNING=&quot;0&quot;&gt;Do you want to link this Opportunity to a different Contract?&lt;/FONT&gt;&lt;/DIV&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Change_Linked_Contract</name>
            <dataType>Boolean</dataType>
            <fieldText>Change Linked Contract?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Change_End_Date</name>
        <label>Change End Date?</label>
        <locationX>1421</locationX>
        <locationY>325</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Change_Date</targetReference>
        </connector>
        <fields>
            <name>Prompt</name>
            <fieldText>{!ContractDetails}</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>blank</name>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>New_End_Date</name>
            <dataType>Date</dataType>
            <defaultValue>
                <elementReference>vEndDate</elementReference>
            </defaultValue>
            <fieldText>New End Date</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
            <validationRule>
                <errorMessage>To extend this Contract you must pick a date after the original end date ({!vEndDate}).</errorMessage>
                <formulaExpression>{!vEndDate}&lt;={!New_End_Date}</formulaExpression>
            </validationRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>No_Active_Contract</name>
        <label>No Active Contract</label>
        <locationX>21</locationX>
        <locationY>591</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Save_Updated_Opp_Record_0</targetReference>
        </connector>
        <fields>
            <name>msg_nf</name>
            <fieldText>&lt;DIV ALIGN=&quot;LEFT&quot;&gt;&lt;FONT FACE=&quot;Arial&quot; STYLE=&quot;font-size:12px&quot; COLOR=&quot;#000000&quot; LETTERSPACING=&quot;0&quot; KERNING=&quot;0&quot;&gt;Neither this Account nor the Top Account in its heirarchy has an active Contract.  Please select &lt;FONT COLOR=&quot;#0000FF&quot;&gt;&lt;B&gt;Next&lt;/B&gt;&lt;/FONT&gt; to continue.&lt;/FONT&gt;&lt;/DIV&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Select_Contract</name>
        <label>Select Contract</label>
        <locationX>443</locationX>
        <locationY>540</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Different_Top_Account_1</targetReference>
        </connector>
        <fields>
            <name>Explanation</name>
            <fieldText>This Account has one or more activated Contracts.  Please select, if applicable, the Contract to be associated with this Opportunity.</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Select_Contract_0</name>
            <choiceReferences>ActivatedContracts</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select Contract</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Select_Contract_1</name>
        <label>Select Contract</label>
        <locationX>443</locationX>
        <locationY>445</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Different_Top_Account_1</targetReference>
        </connector>
        <fields>
            <name>Explanation_1</name>
            <fieldText>This Account and/or the Top Account in its heirarchy has one or more activated Contracts.  Please select, if applicable, the Contract to be associated with this Opportunity</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Select_Contract_Top</name>
            <choiceReferences>ActivatedContracts</choiceReferences>
            <choiceReferences>ActivatedContractsTop</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select Contract</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Wrong_Opp_Type</name>
        <label>Wrong Opp Type</label>
        <locationX>666</locationX>
        <locationY>208</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Save_Updated_Opp_Record</targetReference>
        </connector>
        <fields>
            <name>Msg_0</name>
            <fieldText>&lt;DIV ALIGN=&quot;LEFT&quot;&gt;Selecting an existing Contract to link to an Opportunity is only valid for Opportunity Types: &lt;B&gt;Add/Move/Change&lt;/B&gt;, &lt;B&gt;Service Reduction&lt;/B&gt;, &lt;B&gt;Renewal/NO Changes&lt;/B&gt; or &lt;B&gt;Renewal/With Changes&lt;/B&gt;!&lt;/DIV&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <startElementReference>Get_Opportunity_Record</startElementReference>
    <status>Active</status>
    <textTemplates>
        <name>ContractDetails</name>
        <text>This Contract has a current Start Date of {!objContract.StartDate} with a term of {!objContract.ContractTerm} months and an End Date of {!vEndDate}.

If you want to extend the Contract End Date with this {!objOpp.Type} Opportunity enter a new End Date below.</text>
    </textTemplates>
    <variables>
        <name>colContract</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract</objectType>
    </variables>
    <variables>
        <name>colContractList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract</objectType>
    </variables>
    <variables>
        <name>objContract</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract</objectType>
    </variables>
    <variables>
        <name>objOpp</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>vContract</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>vEndDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>vOppID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
