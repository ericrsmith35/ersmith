<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <assignments>
        <name>Case_Closed_Comments</name>
        <label>Case Closed Comments</label>
        <locationX>470</locationX>
        <locationY>61</locationY>
        <assignmentItems>
            <assignToReference>vStatus</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Status1</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vProblemRes</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Problem_Resolution</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vOutageSteps</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Outage_Prevention_Steps</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vCopperRelated</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Copper_Related</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Contains_POP</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_Errors</name>
        <label>Clear Errors</label>
        <locationX>331</locationX>
        <locationY>54</locationY>
        <assignmentItems>
            <assignToReference>vAllErrors</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue/>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Case_Closed_Comments</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Create_Error_Message</name>
        <label>Create Error Message</label>
        <locationX>757</locationX>
        <locationY>470</locationY>
        <assignmentItems>
            <assignToReference>vAllErrors</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>vError1</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vAllErrors</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>fCRLF</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vAllErrors</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>vError2</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vAllErrors</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>fCRLF</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vAllErrors</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>vError3</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vAllErrors</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>fCRLF</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>vAllErrors</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>vError4</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_there_an_error</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Error_Message_1</name>
        <label>Error Message 1</label>
        <locationX>761</locationX>
        <locationY>65</locationY>
        <assignmentItems>
            <assignToReference>vError1</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PopError</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Contains_System_ID</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Error_Message_2</name>
        <label>Error Message 2</label>
        <locationX>763</locationX>
        <locationY>167</locationY>
        <assignmentItems>
            <assignToReference>vError2</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SystemIDError</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Contains_Outage_Prevention</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Error_Message_3</name>
        <label>Error Message 3</label>
        <locationX>767</locationX>
        <locationY>270</locationY>
        <assignmentItems>
            <assignToReference>vError3</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>OutagePreventErro</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Contains_Problem_Res</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Error_Message_4</name>
        <label>Error Message 4</label>
        <locationX>764</locationX>
        <locationY>366</locationY>
        <assignmentItems>
            <assignToReference>vError4</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ProbResError</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Error_Message</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>Fixed</name>
        <choiceText>Fixed</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Fixed</stringValue>
        </value>
    </choices>
    <choices>
        <name>No</name>
        <choiceText>No</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>No</stringValue>
        </value>
    </choices>
    <choices>
        <name>Not_Fixed</name>
        <choiceText>Not Fixed</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Not Fixed</stringValue>
        </value>
    </choices>
    <choices>
        <name>Temp</name>
        <choiceText>Temp</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Temp</stringValue>
        </value>
    </choices>
    <choices>
        <name>Yes</name>
        <choiceText>Yes</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Yes</stringValue>
        </value>
    </choices>
    <constants>
        <name>cBlank</name>
        <dataType>String</dataType>
        <value>
            <stringValue/>
        </value>
    </constants>
    <constants>
        <name>cDots</name>
        <dataType>String</dataType>
        <value>
            <stringValue>:</stringValue>
        </value>
    </constants>
    <constants>
        <name>cOne</name>
        <dataType>Number</dataType>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </constants>
    <constants>
        <name>OutagePreventErro</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Please Add Outage Prevention Steps before Closing this Case.</stringValue>
        </value>
    </constants>
    <constants>
        <name>PopError</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Please Add a PoP before Closing this Case.</stringValue>
        </value>
    </constants>
    <constants>
        <name>ProbResError</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Please Add a Problem Resolution before Closing this Case.</stringValue>
        </value>
    </constants>
    <constants>
        <name>SystemIDError</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Please Add a System ID before Closing this Case.</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Contains_Outage_Prevention</name>
        <label>Contains Outage Prevention</label>
        <locationX>605</locationX>
        <locationY>273</locationY>
        <defaultConnector>
            <targetReference>Contains_Problem_Res</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>NO3</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vOutageSteps</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue/>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Message_3</targetReference>
            </connector>
            <label>NO</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contains_POP</name>
        <label>Contains POP</label>
        <locationX>605</locationX>
        <locationY>64</locationY>
        <defaultConnector>
            <targetReference>Contains_System_ID</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>NO1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objCase.Number_of_Case_Co_s__c</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Message_1</targetReference>
            </connector>
            <label>NO</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contains_Problem_Res</name>
        <label>Contains Problem Res</label>
        <locationX>609</locationX>
        <locationY>368</locationY>
        <defaultConnector>
            <targetReference>Is_there_an_error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>NO4</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vProblemRes</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue/>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Message_4</targetReference>
            </connector>
            <label>NO</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contains_System_ID</name>
        <label>Contains System ID</label>
        <locationX>607</locationX>
        <locationY>169</locationY>
        <defaultConnector>
            <targetReference>Contains_Outage_Prevention</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>NO2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objCase.Number_of_Case_System_ID_s__c</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <elementReference>cOne</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Message_2</targetReference>
            </connector>
            <label>NO</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_there_an_error</name>
        <label>Is there an error</label>
        <locationX>608</locationX>
        <locationY>470</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>YES5</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vAllErrors</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue/>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Close_Case</targetReference>
            </connector>
            <label>YES</label>
        </rules>
        <rules>
            <name>NO5</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>vAllErrors</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue/>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Case</targetReference>
            </connector>
            <label>NO</label>
        </rules>
    </decisions>
    <description>Added Conga Button</description>
    <dynamicChoiceSets>
        <name>CopperRelated</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Copper_Related__c</picklistField>
        <picklistObject>Case</picklistObject>
    </dynamicChoiceSets>
    <formulas>
        <name>fAPI</name>
        <dataType>String</dataType>
        <expression>{!$Api.Partner_Server_URL_370}</expression>
    </formulas>
    <formulas>
        <name>fCongaURL</name>
        <dataType>String</dataType>
        <expression>&#39;&lt;A HREF=&quot;https://gwi--apxtconga4.na62.visual.force.com/apex/Conga_Composer?serverUrl=https%3A%2F%2Fgwi.my.salesforce.com%2Fservices%2FSoap%2Fu%2F37.0%2F00D6C0000008oXL&amp;id=&#39; &amp; {!vCaseId} &amp; &#39;&amp;QueryId=[OC2]a1A0e00000AhspU,[OC1]a1A0e00000AhspK,[OC3]a1A0e00000Ahw2T&amp;TemplateId=a1B0e00000s2pEl&amp;CongaEmailTemplateId=a190e000002m7Dq&amp;DefaultPDF=1&amp;SC0=1&amp;SC1=Chatter&amp;EmailToId=0030e00002H3TjlAAF&amp;DS7=2&amp;CongaEmailTemplateId=a190e000002m7Dq&amp;OFN=Outage+Report+-+&#39; &amp; {!objCase.Subject} &amp; &#39;&amp;EmailFromId=0D20e000000TPbh&amp;EmailSubject=Outage+Report+-+&#39; &amp; {!objCase.Subject} &amp; &#39;+-+Case+&#39; &amp; {!objCase.CaseNumber} &amp; &#39;&quot;TARGET=&quot;_blank&quot;&gt;&#39; &amp; &#39;&lt;img src=&quot;/resource/APXTConga4__Conga_O_Logo_SM&quot; /&gt;&lt;/A&gt;&#39;</expression>
    </formulas>
    <formulas>
        <name>fCRLF</name>
        <dataType>String</dataType>
        <expression>Substitute({!ttCRLF},&quot;@&quot;, &quot;&quot;)</expression>
    </formulas>
    <interviewLabel>Case - Outage Notification Automation {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Case - Outage Notification Automation</label>
    <processType>Flow</processType>
    <recordLookups>
        <name>Lookup_Case</name>
        <label>Lookup Case</label>
        <locationX>204</locationX>
        <locationY>53</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Clear_Errors</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </filters>
        <object>Case</object>
        <outputReference>objCase</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Subject</queriedFields>
        <queriedFields>CaseNumber</queriedFields>
        <queriedFields>Number_of_Case_Co_s__c</queriedFields>
        <queriedFields>Number_of_Case_System_ID_s__c</queriedFields>
    </recordLookups>
    <recordUpdates>
        <name>Update_Case</name>
        <label>Update Case</label>
        <locationX>608</locationX>
        <locationY>579</locationY>
        <connector>
            <targetReference>Process_Conga</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vCaseId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Copper_Related__c</field>
            <value>
                <elementReference>vCopperRelated</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Outage_Prevention_Steps__c</field>
            <value>
                <elementReference>vOutageSteps</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Problem_Resolution__c</field>
            <value>
                <elementReference>vProblemRes</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <elementReference>vStatus</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <screens>
        <name>Close_Case</name>
        <label>Close Case</label>
        <locationX>75</locationX>
        <locationY>54</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Lookup_Case</targetReference>
        </connector>
        <fields>
            <name>Errors</name>
            <fieldText>{!vAllErrors}</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Status1</name>
            <choiceReferences>Fixed</choiceReferences>
            <choiceReferences>Temp</choiceReferences>
            <dataType>String</dataType>
            <defaultSelectedChoiceReference>Fixed</defaultSelectedChoiceReference>
            <fieldText>Status</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Copper_Related</name>
            <choiceReferences>No</choiceReferences>
            <choiceReferences>Yes</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Copper Related</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Problem_Resolution</name>
            <defaultValue>
                <stringValue/>
            </defaultValue>
            <fieldText>Problem Resolution</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Outage_Prevention_Steps</name>
            <defaultValue>
                <stringValue/>
            </defaultValue>
            <fieldText>Outage Prevention Steps</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Process_Conga</name>
        <label>Process Conga</label>
        <locationX>611</locationX>
        <locationY>668</locationY>
        <allowBack>true</allowBack>
        <allowFinish>false</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>CongaLink</name>
            <fieldText>{!fCongaURL}

Press the Conga sysmbol to produce the Outage Report.</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <startElementReference>Close_Case</startElementReference>
    <status>Active</status>
    <textTemplates>
        <name>ttCRLF</name>
        <text>@
@</text>
    </textTemplates>
    <variables>
        <name>objCase</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Case</objectType>
    </variables>
    <variables>
        <name>vAllErrors</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <name>vCaseId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>vCopperRelated</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>vError1</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>vError2</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>vError3</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>vError4</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>vOutageSteps</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>vProblemRes</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <elementReference>Problem_Resolution</elementReference>
        </value>
    </variables>
    <variables>
        <name>vStatus</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
</Flow>
