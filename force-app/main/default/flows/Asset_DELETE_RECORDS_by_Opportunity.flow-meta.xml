<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <assignments>
        <name>save_upd</name>
        <label>Add to Collection</label>
        <locationX>618</locationX>
        <locationY>420</locationY>
        <assignmentItems>
            <assignToReference>colUpdOli</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>objOLI</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>lpass</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>set_id</name>
        <label>Set ID</label>
        <locationX>193</locationX>
        <locationY>131</locationY>
        <assignmentItems>
            <assignToReference>vID</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opp_ID</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Ass2</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Upd_Oli</name>
        <label>Clear Fields</label>
        <locationX>617</locationX>
        <locationY>285</locationY>
        <assignmentItems>
            <assignToReference>objOLI.Billing_Enabled__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>objOLI.IsConverted__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>objOLI.Date_Sent_to_Billing__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>objOLI.Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue/>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>objOLI.Deliver_to_Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue/>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>objOLI.Service_Address__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue/>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>objOLI.QT_Line__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>save_upd</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>chass</name>
        <label>Assets Found?</label>
        <locationX>86</locationX>
        <locationY>392</locationY>
        <defaultConnector>
            <targetReference>Assd</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>YES</defaultConnectorLabel>
        <rules>
            <name>NONE</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Ass</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Ass2_0</targetReference>
            </connector>
            <label>NONE</label>
        </rules>
    </decisions>
    <decisions>
        <name>chass_0</name>
        <label>Assets Found?</label>
        <locationX>88</locationX>
        <locationY>622</locationY>
        <defaultConnector>
            <targetReference>Assd_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>YES</defaultConnectorLabel>
        <rules>
            <name>NONE_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Ass</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>lass</targetReference>
            </connector>
            <label>NONE</label>
        </rules>
    </decisions>
    <decisions>
        <name>Opp_ID_Entered</name>
        <label>Opp ID Entered?</label>
        <locationX>11</locationX>
        <locationY>131</locationY>
        <defaultConnector>
            <targetReference>Ass2</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NO</defaultConnectorLabel>
        <rules>
            <name>YES</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Opp_ID</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>006</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>set_id</targetReference>
            </connector>
            <label>YES</label>
        </rules>
    </decisions>
    <description>Delete Assets and reset Billing Enabled fields</description>
    <dynamicChoiceSets>
        <name>Opp</name>
        <dataType>String</dataType>
        <displayField>Name</displayField>
        <filters>
            <field>TEST__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <outputAssignments>
            <assignToReference>vID</assignToReference>
            <field>Id</field>
        </outputAssignments>
        <sortField>Name</sortField>
        <sortOrder>Asc</sortOrder>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <interviewLabel>Asset - DELETE RECORDS by Opportunity {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Asset - DELETE RECORDS by Opportunity</label>
    <loops>
        <name>lpass</name>
        <label>Process Each One</label>
        <locationX>406</locationX>
        <locationY>283</locationY>
        <assignNextValueToReference>objOLI</assignNextValueToReference>
        <collectionReference>colOLI</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Upd_Oli</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>uoli</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processType>Flow</processType>
    <recordDeletes>
        <name>Assd</name>
        <label>Delete Them</label>
        <locationX>256</locationX>
        <locationY>395</locationY>
        <connector>
            <targetReference>Ass2_0</targetReference>
        </connector>
        <inputReference>Ass</inputReference>
    </recordDeletes>
    <recordDeletes>
        <name>Assd_0</name>
        <label>Delete Them</label>
        <locationX>267</locationX>
        <locationY>624</locationY>
        <connector>
            <targetReference>lass</targetReference>
        </connector>
        <inputReference>Ass</inputReference>
    </recordDeletes>
    <recordLookups>
        <name>Ass2</name>
        <label>Get Purchased Assets</label>
        <locationX>87</locationX>
        <locationY>278</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>chass</targetReference>
        </connector>
        <filters>
            <field>Purchase_Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vID</elementReference>
            </value>
        </filters>
        <object>Asset</object>
        <outputReference>Ass</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Ass2_0</name>
        <label>Get Disconnected Assets</label>
        <locationX>88</locationX>
        <locationY>506</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>chass_0</targetReference>
        </connector>
        <filters>
            <field>Disconnect_Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vID</elementReference>
            </value>
        </filters>
        <object>Asset</object>
        <outputReference>Ass</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>lass</name>
        <label>Get Opp&#39;s Products</label>
        <locationX>405</locationX>
        <locationY>483</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>lpass</targetReference>
        </connector>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vID</elementReference>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <outputReference>colOLI</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>IsConverted__c</queriedFields>
    </recordLookups>
    <recordUpdates>
        <name>Clear_Opp_Fields</name>
        <label>Clear Opp Fields</label>
        <locationX>616</locationX>
        <locationY>131</locationY>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>vID</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Bill_To_Account__c</field>
            <value>
                <stringValue/>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contact_r__c</field>
            <value>
                <stringValue/>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Delivery_Stage__c</field>
            <value>
                <stringValue>In Progress</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Primary_Dlvr_To_Acct__c</field>
            <value>
                <stringValue/>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Primary_Service_Address__c</field>
            <value>
                <stringValue/>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WFR_Delivery_Contact__c</field>
            <value>
                <stringValue/>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <recordUpdates>
        <name>uoli</name>
        <label>Save Changes</label>
        <locationX>407</locationX>
        <locationY>132</locationY>
        <connector>
            <targetReference>Clear_Opp_Fields</targetReference>
        </connector>
        <inputReference>colUpdOli</inputReference>
    </recordUpdates>
    <screens>
        <name>Select_Opp_to_Reset</name>
        <label>Select Opp to Reset</label>
        <locationX>11</locationX>
        <locationY>22</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Opp_ID_Entered</targetReference>
        </connector>
        <fields>
            <name>t1</name>
            <fieldText>For Testing Only - Delete All Assets on Opportunity</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Opportunity</name>
            <choiceReferences>Opp</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Opportunity</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>or</name>
            <fieldText>-OR-</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Opp_ID</name>
            <dataType>String</dataType>
            <fieldText>Opp ID</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <startElementReference>Select_Opp_to_Reset</startElementReference>
    <status>Draft</status>
    <variables>
        <name>Ass</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Asset</objectType>
    </variables>
    <variables>
        <name>colOLI</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>colUpdOli</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>objOLI</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>vID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
